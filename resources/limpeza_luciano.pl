#! perl -w
use strict;
if ($#ARGV < 0) { die "Modo de uso: perl -w $0 <scaffold inicial>\n"; }
my $arq = $ARGV[0];

my @COLS;
my %COLS;

my $c10 = chr 10;
my $c13 = chr 13;


my $id = '';
my @c;
my $tam = 0;
my $seq = "";
open IN, "< $arq" or die "Nao foi possivel abrir o arquivo de entrada '$arq'.\n";
while (<IN>){
	chomp;
	$_ =~s/$c10//g;
	$_ =~s/$c13//g;
	if ($_ =~ '>'){
		print "$_\n";
		if ($id ne ''){
			warn "$id\t$tam\n";
		}
		$id = $_;
		$tam = 0;
	}else{
		$tam += length $_;
		$seq .= $_;
	}

}
close IN;
if ($id ne ''){
	warn "$id\t$tam\n";
}


my $cont = 0;
my @EXC = split ',', "103300-103390,103635-103685,311718-311750,311851-311876,344891-344920,369728-369818,438552-438598,743742-743783,743998-744056,893126-893176,1008841-1008908,1126472-1126502,1400018-1400112,1751675-1751713,1751943-1751993,1891522-1891572,1970109-1970155,1970400-1970448,2273418-2273480,2274635-2274681,2583705-2583729,2583920-2583994,2668943-2669029,2922646-2922737,2923358-2923404,2923733-2923779,3001359-3001404,3797039-3797085,3973655-3973743,4067203-4067257,4067460-4067504,4431210-4431272,4584193-4584243,4609986-4610034,4720746-4720805,4857270-4857316,4857600-4857646,5171583-5171629,5171815-5171841,5182039-5182085,5182323-5182366,5403181-5403208,5531684-5531703,5595934-5595980,5596271-5596308,5667102-5667148,5667321-5667375,5802726-5802808,5807128-5807172,5928775-5928804,6039476-6039530";
my $min = 10000000000000000;
my $max = 0;
my $l;
my $temp;
my $N = 'NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN';
foreach (@EXC){
	@c = split '-', $_;
	$tam = length $seq;
	$cont++;
#	warn "".($tam)."\t$c[0]\t$c[1]\n";
	$l = $c[1] - $c[0]+1;
	if ($min > $l){
		$min = $l;
	}
	if ($max < $l){
		$max = $l;
	}
#	warn "$_ YYYYYYYYYYYYYY\n";
	warn "[$cont]\t".substr($seq, $c[0]-1, $l)."\n";
#	warn "\# $c[0]\t$c[1]\t$l\t$tam\n";
	$temp = substr($seq, 0, $c[0]-1) . substr($N, 0, $l) . substr($seq, $c[1], $tam - $c[1]);
	$seq = $temp;

#	print substr($seq, 0, 200) . "\n";
#	exit 0;

}
warn "Minimo: $min\n";
warn "Maximo: $max\n";

###print "$seq\n";





my $N100 = 'NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN';

my $res = "";
$min = 10000000000000;
@c = split "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN+", $seq;
#@c = split "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN+", $seq;
foreach (@c){
	$l = length $_;
	warn "$#c ".($l)."\t".(length $res)."\n";
	if ($l >= 200){
		if ($res ne ""){
			$res .= "$N100";
		}
		$res .= "$_";
	}
	if ($l<$min){
		$min = $l;
	}
}

warn "Minimo: $min\n";

print $res;
warn "Tamanho:\t". (length $res) . "\n";
